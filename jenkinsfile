@Library('jenkins-shared-library@master') _
pipeline {
  agent any
  stage ('SonarQube Analysis') {
            when {
                anyOf {
                    branch "develop"
                    branch "release-*"
                    branch "hotfix-*"
                }
                expression { !params.SKIP_CODE_ANALYSIS }
                anyOf {
            		expression { params.MODE == 'Build & Deploy'}
            		expression { params.MODE == 'Build Only' }
            	}
            }
            steps {
                script {
                	def config = config()
                    def SQscannerHome = tool config.sonarqube_installation_tool
                    withSonarQubeEnv(config.sonarqube_installation_name) {
                        sh "${SQscannerHome}/bin/sonar-scanner"
                    }
                }
            }
        }
}
